# Health Endpoint Deployment

This repository contains the code and instructions for deploying a simple Health check API using Azure Kubernetes Service (AKS), Azure Container Registry (ACR), and GitHub Actions for CI/CD. The Health check API is built using Node.js and is designed to expose a single endpoint, `/status`, that returns a JSON response `{ "status": "ok" }`.


## Getting Started

### Building and Deploying the Service

1. Clone this repository to your local machine:

   git clone https://github.com/reshikasandeepa/kodez-assignment.git

2. Navigate to the project directory:

   cd kodez-assignment

3. Creating Isfrastructure using IaC

   First, you need to create a storage account in a seperate resource group. Then in storage account create a container named tfstate. Then go the terraform directory and open the provider file replace the "resource_group_name" and "remotetfstatetf" with the created storage account name and the resource group the storage acoount is created.
   Above steps is the keep the state remotely as a best practice.

   Then authenticate with azure account using "az login" command. (you neeed have azure cli installed to run this)
   Once the authentication is completed. switch the terraform directory.

   Once all the variables are checked, execute below commands to create the required infrastructure.
    terraform init
    terraform plan
    terraform apply -auto-approve (if everything looks good in plan output)

## Monitoring
    In current deployed cluster there is a grafana is running. You can access the grafana using below url.
    http://168.61.49.2/login

### Accessing Logs

Logs generated by the application are available in Azure Application Insights. You can access logs and monitoring information through the Azure Portal.

## CI/CD

This repository is configured with GitHub Actions for CI/CD. The CI/CD pipeline is defined in the [.github/workflows/]. It automates the deployment process from the main branch. Once the main branch is updated it will trigger the CI/CD and will deploy the latest code into the AKS cluster.

## Testing the Health Endpoint

The Health check API is accessible at the following URL:

http://20.25.47.22/status

You can use a tool like `curl` or a web browser to access the endpoint and verify that it returns the expected JSON response.

## Repository Structure

- `healthcheck-application/`: Contains the source code for the Node.js Health check API.
- `.github/workflows/`: Contains GitHub Actions workflows for CI/CD.
- `terraforms`: Contains the terraform files to create the infrastructure.